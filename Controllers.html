<!doctype html>
<html lang="en" data-bs-theme="dark">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=1024, initial-scale=1">
    <title>HefestosPHP Docs</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">

    <link rel="stylesheet" href="./assets/style.css">
    <script src="./assets/js/menu.js?v=0.3"></script>
    <!-- Highlight.js CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/base16/onedark.min.css">
    <!-- Highlight.js Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/armasm.min.js"></script>
    <!-- Enable Highlight.js -->
    <script>hljs.highlightAll();</script>
    <script defer type="module" src="./assets/js/behaviors.js?v=0.3"></script>
</head>

<body>
    <div class="row container-fluid min-vh-100">
        <aside class="col-custom-2-5  border-end ps-1">

        </aside>


        <main class="col-custom-9-5 p-5">
            <h2 class="mb-5">Pasta Controllers</h2>
            <div class="p-3">
            <section class="ps-3">
                <p>
                    É na pasta Controllers que ficarão todos os seus controllers, ou seja, as classes responsáveis por
                    coordenar as repostas às requisicoes.
                </p>
                <p>
                    Por exemplo, comumente o seu controller vai acessar o seu banco de dados através de uma
                    <a href="/Models.html">model</a> e então retornar esses dados como um json ou passa-los
                    para uma <a href="/Views.html">view</a> que irá preencher o html a ser retornado para o usuário. Aqui está uma visão geral:
                </p>
                <ul class="ps-4">
                    <li><a class="link-lava" href="#Criando-um-Controller">Criando um Controller</a></li>
                    <li><a class="link-lava" href="#Recebendo-dados-da-url">Recebendo dados da url</a></li>
                    <li><a class="link-lava" href="#Acessando-parâmetros-get-e-pos">Acessando parâmetros get e post</a></li>
                    <li><a class="link-lava" href="#Retornando-uma-resposta">Retornando uma resposta</a></li>
                </ul>
            </section>
            <section class="pt-5" id="Criando-um-Controller">
                <h4>Criando um Controller</h4>
                <div class="p-3">
                    <p>
                        Você pode usar a <a href="/Forja.html">forja</a> para criar um controller, basta utilizar o
                        comando "criar"
                        seguido do tipo de arquivo desejado (controller) e o nome do controller desejado. Por exemplo,
                        com o comando da forja:
                    </p>
                    <div class="position-relative">
                        <pre><code class="language-armasm rounded border-0">php forja criar controller UsuariosController</code></pre>
                        <button class="btn btn-outline-secondary position-absolute top-0 end-0 mt-1 me-2 p-0"
                               style="padding: 2px 2px 3px 2px!important; border: 0 !important; background: fixed;"
                                data-copiar
                                title="Copiar"
                                >
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" 
                                class="bi bi-clipboard2-fill" viewBox="0 0 16 16">
                                <path d="M9.5 0a.5.5 0 0 1 .5.5.5.5 0 0 0 .5.5.5.5 0 0 1 .5.5V2a.5.5 0 0 1-.5.5h-5A.5.5 0 0 1 5 2v-.5a.5.5 0 0 1 .5-.5.5.5 0 0 0 .5-.5.5.5 0 0 1 .5-.5z"/>
                                <path d="M3.5 1h.585A1.5 1.5 0 0 0 4 1.5V2a1.5 1.5 0 0 0 1.5 1.5h5A1.5 1.5 0 0 0 12 2v-.5q-.001-.264-.085-.5h.585A1.5 1.5 0 0 1 14 2.5v12a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 14.5v-12A1.5 1.5 0 0 1 3.5 1"/>
                            </svg>
                        </button>
                    </div>
                    <p>
                        O seguinte arquivo UsuariosController.php será criado na pasta Controllers:
                    </p>
                    <div>
                        <div class="position-relative">
                            <pre><code class="language-php rounded border-0">&lt;?php

namespace App\Controllers;

use Hefestos\Core\Controller;

class UsuariosController extends Controller
{
    public function index()
    {
        // return view();
        // ou
        // return json();
        // ou ainda
        // return redirecionar(); 
    }
}</code></pre>
                            <button class="btn btn-outline-secondary position-absolute top-0 end-0 mt-1 me-2 p-0"
                                    style="padding: 2px 2px 3px 2px!important; border: 0 !important; background: fixed;"
                                    data-copiar
                                    title="Copiar"
                                    >
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" 
                                    class="bi bi-clipboard2-fill" viewBox="0 0 16 16">
                                    <path d="M9.5 0a.5.5 0 0 1 .5.5.5.5 0 0 0 .5.5.5.5 0 0 1 .5.5V2a.5.5 0 0 1-.5.5h-5A.5.5 0 0 1 5 2v-.5a.5.5 0 0 1 .5-.5.5.5 0 0 0 .5-.5.5.5 0 0 1 .5-.5z"/>
                                    <path d="M3.5 1h.585A1.5 1.5 0 0 0 4 1.5V2a1.5 1.5 0 0 0 1.5 1.5h5A1.5 1.5 0 0 0 12 2v-.5q-.001-.264-.085-.5h.585A1.5 1.5 0 0 1 14 2.5v12a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 14.5v-12A1.5 1.5 0 0 1 3.5 1"/>
                                </svg>
                            </button>
                        </div>
                        <!-- <img src="./assets/img/controllers-1.webp?v=0.3" class="img-fluid"> -->
                    </div>
                </div>
            </section>
            <section class="pt-2" id="Recebendo-dados-da-url">
                <h4>Recebendo dados da url</h4>
                <div class="p-3">
                    <p>
                        Para acessar as variáveis recebidas diretamente na url da rota através das parâmetros dinâmicos basta
                        declarar seu método de modo a esperar o mesmo número de parâmetros da rota. Por
                        exemplo:
                    </p>
                    <div>
                        <div class="position-relative">
                            <pre><code class="language-php rounded border-0">// --rotas.php
// A seguinte rota tem dois parâmetros dinâmicos (ex .: /usuario/13/pet/02)
$rotas->get('/usuario/{id_usuario}/pet/{id_pet}', 'UsuariosController::buscarPet');

// --UsuariosController.php
// O método deve então esperar dois parâmetros, nomeados como bem desejar
public function buscarPet($id_usuario, $id_pet)
{
    // No nosso exemplo $id_usuario terá valor "13" e $id_pet terá valor "02"
}
</code></pre>
                            <button class="btn btn-outline-secondary position-absolute top-0 end-0 mt-1 me-2 p-0"
                                    style="padding: 2px 2px 3px 2px!important; border: 0 !important; background: fixed;"
                                    data-copiar
                                    title="Copiar"
                                    >
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" 
                                    class="bi bi-clipboard2-fill" viewBox="0 0 16 16">
                                    <path d="M9.5 0a.5.5 0 0 1 .5.5.5.5 0 0 0 .5.5.5.5 0 0 1 .5.5V2a.5.5 0 0 1-.5.5h-5A.5.5 0 0 1 5 2v-.5a.5.5 0 0 1 .5-.5.5.5 0 0 0 .5-.5.5.5 0 0 1 .5-.5z"/>
                                    <path d="M3.5 1h.585A1.5 1.5 0 0 0 4 1.5V2a1.5 1.5 0 0 0 1.5 1.5h5A1.5 1.5 0 0 0 12 2v-.5q-.001-.264-.085-.5h.585A1.5 1.5 0 0 1 14 2.5v12a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 14.5v-12A1.5 1.5 0 0 1 3.5 1"/>
                                </svg>
                            </button>
                        </div>
                        <!-- <img src="./assets/img/controllers-2.webp?v=0.3" class="img-fluid"> -->
                    </div>
                </div>
            </section>
            <section class="pt-2" id="Acessando-parâmetros-get-e-pos">
                <h4>Acessando parâmetros get e post</h4>
                <div class="p-3">
                    <p>
                        Comumente você precisará receber dados enviados por parâmetros "get" ou "post" e, para tal,
                        basta utilizar os métodos <code>dadosGet</code> ou <code>dadosPost</code> respectivamente,
                        herdados do Controller base do Hefestos.
                    </p>
                    <p>
                        Estes métodos fornecem uma maneira limpa e conveniente de acessar um array associativo padrão do
                        PHP para recuperar os dados recebidos e os higieniza para maior segurança do sistema.
                    </p>
                    <p>
                        Ambos os métodos funcionam da mesma forma, sendo a única diferença o array de dados que acessam.
                        Eles aceitam dois parâmetros: uma string ou array com os dados desejados e um booleano indicando a 
                        higienização que, por padrão, é <code>true</code>.
                    </p>
                    <p>
                        Vamos supor o seguinte exemplo de dados enviados em uma requisição GET:
                    </p>
                    <pre><p class="alert alert-dark">[
   'id' => '03',
   'apelido' => 'silva',
   'comentario' => &gt; "&lt;script&gt; alert('script malicioso haha!') &lt;/script&gt;"
]</p></pre>
                    <p>
                        Desse modo, no método do seu controller você pode usar:
                    </p>
                    <div>
                        <div class="position-relative">
                            <pre><code class="language-php rounded border-0">public function exemplo()
{
    // Se nada for informado retorna todos os dados higienizados
    $tudo = $this->dadosGet();

    // Informar a chave desejada retornará o seu valor diretamente
    $id_usuario = $this->dadosGet('id'); // '03'

    // Informar um array com as chaves desejadas retorna um array associativo com seus valores
    $id_e_apelido = $this->dadosGet(['id', 'apelido' ]); // ['id' = '03', 'apelido' = 'silva']
}</code></pre>
                            <button class="btn btn-outline-secondary position-absolute top-0 end-0 mt-1 me-2 p-0"
                                    style="padding: 2px 2px 3px 2px!important; border: 0 !important; background: fixed;"
                                    data-copiar
                                    title="Copiar"
                                    >
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" 
                                    class="bi bi-clipboard2-fill" viewBox="0 0 16 16">
                                    <path d="M9.5 0a.5.5 0 0 1 .5.5.5.5 0 0 0 .5.5.5.5 0 0 1 .5.5V2a.5.5 0 0 1-.5.5h-5A.5.5 0 0 1 5 2v-.5a.5.5 0 0 1 .5-.5.5.5 0 0 0 .5-.5.5.5 0 0 1 .5-.5z"/>
                                    <path d="M3.5 1h.585A1.5 1.5 0 0 0 4 1.5V2a1.5 1.5 0 0 0 1.5 1.5h5A1.5 1.5 0 0 0 12 2v-.5q-.001-.264-.085-.5h.585A1.5 1.5 0 0 1 14 2.5v12a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 14.5v-12A1.5 1.5 0 0 1 3.5 1"/>
                                </svg>
                            </button>
                        </div>
                        <!-- <img src="./assets/img/controllers-3.webp?v=0.3" class="img-fluid"> -->
                    </div>
                    <p class="mt-5">
                        Porém, como dito anteriormente, os dados são retornados higienizados por padrão para maior segurança,
                        assim removendo quaisquer tags que alguém mal intencionado tente inserir e, nesse caso,
                        impedindo a interpretação do javascript:
                    </p>
                    <div>
                        <div class="position-relative">
                            <pre><code class="language-php rounded border-0">public function exemplo()
{
    // Por padrão o item será higienizado e as tags removidas
    $comentario = $this->dadosGet('comentario'); // alert('script malicioso haha!')

    // Caso não queira higienizar os itens basta passar false no segundo parâmetro
    $comentario = $this->dadosGet('comentario', false); // &lt;script&gt; alert('script malicioso haha!') &lt;/script&gt;
}</code></pre>
                            <button class="btn btn-outline-secondary position-absolute top-0 end-0 mt-1 me-2 p-0"
                                    style="padding: 2px 2px 3px 2px!important; border: 0 !important; background: fixed;"
                                    data-copiar
                                    title="Copiar"
                                    >
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" 
                                    class="bi bi-clipboard2-fill" viewBox="0 0 16 16">
                                    <path d="M9.5 0a.5.5 0 0 1 .5.5.5.5 0 0 0 .5.5.5.5 0 0 1 .5.5V2a.5.5 0 0 1-.5.5h-5A.5.5 0 0 1 5 2v-.5a.5.5 0 0 1 .5-.5.5.5 0 0 0 .5-.5.5.5 0 0 1 .5-.5z"/>
                                    <path d="M3.5 1h.585A1.5 1.5 0 0 0 4 1.5V2a1.5 1.5 0 0 0 1.5 1.5h5A1.5 1.5 0 0 0 12 2v-.5q-.001-.264-.085-.5h.585A1.5 1.5 0 0 1 14 2.5v12a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 14.5v-12A1.5 1.5 0 0 1 3.5 1"/>
                                </svg>
                            </button>
                        </div>
                        <!-- <img src="./assets/img/controllers-4.webp?v=0.3" class="img-fluid"> -->
                    </div>
                </div>
            </section>
            <section class="pt-2" id="Retornando-uma-resposta">
                <h4>Retornando uma resposta</h4>
                <div class="p-3">
                    <p>
                        Finalmente, talvez após recuperar alguns dados de uma <a href="/Models.html">model</a> ou uma API de terceiros, 
                        você deve sempre retornar a resposta do método utilizando <code>return</code>, normalmente uma view com HTML, um JSON ou ainda um <a href="/Auxiliares.html#redirecionar">redirecionar()</a>.
                    </p>
                    <p>
                        Para retornar uma página HTML você deve utulizar a função auxiliar <code><a href="/Auxiliares.html#view">view()</a></code>. 
                        Nela, o primeiro parâmetro é o nome da sua view e o segundo um array associativo indicando os dados que 
                        estarão disponíveis para essa view. Por exemplo:
                    </p>
                    <div>
                        <img src="./assets/img/controllers-5.webp?v=0.3" class="img-fluid">
                    </div>
                    <p class="mt-5">
                        Porém, talvez você esteja fazendo uma API e quer apenas retornar esses dados como um JSON para o cliente. 
                        Para tal, basta usar a função auxiliar <code><a href="/Auxiliares.html#json">json()</a></code>, informando o array desejado.
                    </p>
                    <div>
                        <img src="./assets/img/controllers-6.webp?v=0.3" class="img-fluid">
                    </div>
                    <p class="mt-5">
                        Por fim, talvez você precise redirecionar o usuário ao invés de fornecer uma resposta em texto, como por exemplo em casos 
                        de validações. Para tal, utilize a função auxiliar <code><a href="/Auxiliares.html#redirecionar">redirecionar()</a></code>, podendo simplesmente informar a nova url desejada.
                    </p>
                    <div>
                        <img src="./assets/img/controllers-7.webp?v=0.3" class="img-fluid">
                    </div>
                </div>
            </section>
        </div>
        </main>

    </div>
    <button class="btn position-fixed bottom-0 end-0 m-4 p-1" id="myBtn" title="voltar pro topo">
    </button>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
        crossorigin="anonymous"></script>
</body>

</html>